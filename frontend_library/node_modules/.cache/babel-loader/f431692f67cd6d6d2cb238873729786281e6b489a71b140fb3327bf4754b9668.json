{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/default.jpeg';\nconst _withScopeId = n => (_pushScopeId(\"data-v-207515d6\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  style: {\n    \"text-align\": \"center\",\n    \"font-weight\": \"bold\",\n    \"margin-top\": \"2%\"\n  }\n}, \"Your Books\", -1 /* HOISTED */));\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  class: \"row\"\n};\nconst _hoisted_4 = {\n  class: \"card-body\"\n};\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  key: 1,\n  src: _imports_0,\n  class: \"card-img-top\",\n  alt: \"Default Cover\"\n};\nconst _hoisted_7 = {\n  class: \"card-subtitle mb-2 text-muted\",\n  style: {\n    \"text-align\": \"center\"\n  }\n};\nconst _hoisted_8 = {\n  class: \"book-actions d-flex text-center\",\n  style: {\n    \"justify-content\": \"center\"\n  }\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_NavBar = _resolveComponent(\"NavBar\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_NavBar), _hoisted_1, $data.myBooks.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.myBooks, book => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: book.book_id,\n      class: \"card\",\n      style: {\n        \"background-color\": \"whitesmoke\"\n      }\n    }, [_createElementVNode(\"div\", _hoisted_4, [book.coverUrl ? (_openBlock(), _createElementBlock(\"img\", {\n      key: 0,\n      src: book.coverUrl,\n      class: \"card-img-top\",\n      alt: \"Book Cover\"\n    }, null, 8 /* PROPS */, _hoisted_5)) : (_openBlock(), _createElementBlock(\"img\", _hoisted_6)), _createElementVNode(\"h6\", _hoisted_7, \" by \" + _toDisplayString(book.authors), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"button\", {\n      type: \"button\",\n      class: \"btn btn-primary mr-2\",\n      onClick: $event => $options.readBook(book.book_id)\n    }, \" Read \", 8 /* PROPS */, _hoisted_9), _createElementVNode(\"button\", {\n      type: \"button\",\n      class: \"btn btn-warning\",\n      onClick: $event => $options.returnBook(book.book_id, book.user_id)\n    }, \" Return \", 8 /* PROPS */, _hoisted_10)])])]);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["_imports_0","_createElementVNode","style","key","class","src","alt","_createElementBlock","_createVNode","_component_NavBar","_hoisted_1","$data","myBooks","length","_hoisted_2","_hoisted_3","_Fragment","_renderList","book","book_id","_hoisted_4","coverUrl","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","authors","_hoisted_8","type","onClick","$event","$options","readBook","_hoisted_9","returnBook","user_id","_hoisted_10","_createCommentVNode"],"sources":["C:\\Users\\vijay\\OneDrive\\Desktop\\National-Library-LMS\\Library_Code\\frontend_library\\src\\views\\User\\IssuedBooks.vue"],"sourcesContent":["<template>\n  <div>\n    <NavBar />\n    <h3 style=\"text-align: center;font-weight: bold;margin-top: 2%;\">Your Books</h3>\n\n    <div v-if=\"myBooks.length > 0\">\n      <div class=\"row\">\n        <div v-for=\"book in myBooks\" :key=\"book.book_id\" class=\"card\" style=\"background-color: whitesmoke;\">\n          <div class=\"card-body\">\n            <template v-if=\"book.coverUrl\">\n              <img :src=\"book.coverUrl\" class=\"card-img-top\" alt=\"Book Cover\">\n            </template>\n            <template v-else>\n              <img src=\"@/assets/default.jpeg\" class=\"card-img-top\" alt=\"Default Cover\">\n            </template>\n            <h6 class=\"card-subtitle mb-2 text-muted\" style=\"text-align: center;\"> by {{ book.authors }}</h6>\n            <div class=\"book-actions d-flex text-center\" style=\"justify-content: center;\">\n              <button type=\"button\" class=\"btn btn-primary mr-2\" @click=\"readBook(book.book_id)\">\n                Read\n              </button>\n              <button type=\"button\" class=\"btn btn-warning\" @click=\"returnBook(book.book_id, book.user_id)\">\n                Return\n              </button>\n\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"../../components/NavBar.vue\"; // Make sure to adjust the path if necessary\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      myBooks: [],\n      rating: null,\n      comments: \"\",\n      searchQuery: \"\",\n    };\n  },\n\n  methods: {\n    readBook(book_id) {\n      this.$router.push({ name: 'BookPage', params: { id: book_id} });\n    },\n    searchBooks() {\n      return this.myBooks.filter(book => {\n        const searchMatch =\n          (book.name && book.name.toLowerCase().includes(this.searchQuery.toLowerCase())) ||\n          (book.authors && book.authors.toLowerCase().includes(this.searchQuery.toLowerCase()));\n        return (this.searchQuery === \"\" || searchMatch);\n      });\n    }\n    ,\n    async fetchIssuedBooks() {\n      try {\n        const response = await axios.get(\n          \"http://127.0.0.1:5000/api/fetch_my_books\",\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n            }\n          }\n        );\n        if (response.status === 200) {\n          this.myBooks = response.data;\n          await this.fetchBookCovers();\n        } else {\n          console.error(\"Failed to fetch my books\");\n        }\n      } catch (error) {\n        console.error(\"Error fetching my books:\", error);\n      }\n    },\n    async fetchBookCovers() {\n      for (const book of this.myBooks) {\n        try {\n          const coverUrl = await this.getBookCover(book);\n          book.coverUrl = coverUrl;\n        } catch (error) {\n          console.error(\"Error fetching book cover:\", error);\n          book.coverUrl = null;\n        }\n      }\n    },\n    \n    getBookCover(book) {\n      const apiUrl = `http://localhost:5000/bookcover?book_title=${encodeURIComponent(book.name)}\n      &author_name=${encodeURIComponent(book.authors)}\n      &isbn=${encodeURIComponent(book.isbn)}`;\n\n      return axios\n        .get(apiUrl)\n        .then((response) => {\n          console.log(response.data);\n          return response.data;\n        })\n        .catch((error) => {\n          console.error(\"Error fetching book cover:\", error);\n          return null;\n        });\n    },\n    async returnBook(book_id, user_id) {\n      try {\n        const response = await axios.post(\n          \"http://127.0.0.1:5000/api/return/book\",\n          {\n            book_id: book_id,\n            user_id: user_id\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n            }\n          }\n        );\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.fetchIssuedBooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    },\n \n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = Math.ceil(differenceMs / (1000 * 60 * 60 * 24)) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  },\n  mounted() {\n    this.fetchIssuedBooks();\n  },\n  components: {\n    NavBar\n  }\n};\n</script>\n\n<style scoped>\n.btn {\n  display: flex;\n  justify-content: center;\n  background-color: coral;\n  color: white;\n  border: none;\n  margin-left: 10px;\n  margin-top: 5px;\n  margin-bottom: 5px;\n  padding: 5px 10px;\n}\n\n.btn:hover {\n  background-color: #ff4500;\n}\n\n.ano {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 5px;\n}\n\n\n.book-cover {\n  height: 150px;\n  align-items: start;\n  object-fit: contain;\n  margin-bottom: 0.25rem;\n}\n\n.book-cover.disabled-image {\n  opacity: 0.5;\n}\n\n\n\n.row {\n  margin-left: 0.75%;\n  align-items: stretch;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n\n.card {\n  max-width: 13.333%;\n  padding: .75rem;\n  margin-bottom: 2rem;\n  border: 0;\n  flex-basis: 33.333%;\n  flex-grow: 0;\n  flex-shrink: 0;\n}\n\n.card-img-top {\n  margin-bottom: .75rem;\n  width: 100%;\n  height: 300px;\n}\n\n.card-text {\n  font-size: 85%;\n}\n</style>\n"],"mappings":";OAamBA,UAA2B;;gEAV1CC,mBAAA,CAAgF;EAA5EC,KAA4D,EAA5D;IAAA;IAAA;IAAA;EAAA;AAA4D,GAAC,YAAU;;EAH/EC,GAAA;AAAA;;EAMWC,KAAK,EAAC;AAAK;;EAEPA,KAAK,EAAC;AAAW;mBARhC;;EAAAD,GAAA;EAamBE,GAA2B,EAA3BL,UAA2B;EAACI,KAAK,EAAC,cAAc;EAACE,GAAG,EAAC;;;EAExDF,KAAK,EAAC,+BAA+B;EAACF,KAA2B,EAA3B;IAAA;EAAA;;;EACrCE,KAAK,EAAC,iCAAiC;EAACF,KAAgC,EAAhC;IAAA;EAAA;;mBAhBzD;oBAAA;;;uBACEK,mBAAA,CA4BM,cA3BJC,YAAA,CAAUC,iBAAA,GACVC,UAAgF,EAErEC,KAAA,CAAAC,OAAO,CAACC,MAAM,Q,cAAzBN,mBAAA,CAuBM,OA5BVO,UAAA,GAMMb,mBAAA,CAqBM,OArBNc,UAqBM,I,kBApBJR,mBAAA,CAmBMS,SAAA,QA1BdC,WAAA,CAO4BN,KAAA,CAAAC,OAAO,EAAfM,IAAI;yBAAhBX,mBAAA,CAmBM;MAnBwBJ,GAAG,EAAEe,IAAI,CAACC,OAAO;MAAEf,KAAK,EAAC,MAAM;MAACF,KAAqC,EAArC;QAAA;MAAA;QAC5DD,mBAAA,CAiBM,OAjBNmB,UAiBM,GAhBYF,IAAI,CAACG,QAAQ,I,cAC3Bd,mBAAA,CAAgE;MAV9EJ,GAAA;MAUoBE,GAAG,EAAEa,IAAI,CAACG,QAAQ;MAAEjB,KAAK,EAAC,cAAc;MAACE,GAAG,EAAC;4BAVjEgB,UAAA,M,cAacf,mBAAA,CAA0E,OAA1EgB,UAA0E,IAE5EtB,mBAAA,CAAiG,MAAjGuB,UAAiG,EAA3B,MAAI,GAAAC,gBAAA,CAAGP,IAAI,CAACQ,OAAO,kBACzFzB,mBAAA,CAQM,OARN0B,UAQM,GAPJ1B,mBAAA,CAES;MAFD2B,IAAI,EAAC,QAAQ;MAACxB,KAAK,EAAC,sBAAsB;MAAEyB,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAC,QAAQ,CAACd,IAAI,CAACC,OAAO;OAAG,QAEnF,iBAnBdc,UAAA,GAoBchC,mBAAA,CAES;MAFD2B,IAAI,EAAC,QAAQ;MAACxB,KAAK,EAAC,iBAAiB;MAAEyB,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAG,UAAU,CAAChB,IAAI,CAACC,OAAO,EAAED,IAAI,CAACiB,OAAO;OAAG,UAE9F,iBAtBdC,WAAA,E;wCAAAC,mBAAA,e","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}