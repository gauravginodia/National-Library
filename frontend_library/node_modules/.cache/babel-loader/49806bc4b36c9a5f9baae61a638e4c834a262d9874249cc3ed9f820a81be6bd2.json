{"ast":null,"code":"import NavBar from \"../../components/NavBar.vue\";\nimport axios from \"axios\";\nexport default {\n  name: \"AssignedBooks\",\n  components: {\n    NavBar\n  },\n  data() {\n    return {\n      listallocated: []\n    };\n  },\n  created() {\n    this.listofallocatedbooks();\n  },\n  methods: {\n    async listofallocatedbooks() {\n      try {\n        const headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        headers.append(\"Authorization\", `Bearer ${localStorage.getItem(\"accessToken\")}`);\n        const response = await fetch(\"http://127.0.0.1:5000/api/librarian/allocated_books\", {\n          method: \"PUT\",\n          headers: headers\n        });\n        if (!response.ok) {\n          throw new Error(\"Failed to fetch allocated books\");\n        }\n        const data = await response.json();\n        this.listallocated = data;\n        console.log(this.listallocated);\n        console.log(data);\n      } catch (error) {\n        console.error(\"Error:\", error.message);\n      }\n    },\n    async takeawayaccess(allocation_id, book_id, user_id) {\n      try {\n        const headers = {\n          Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n        };\n        const response = await axios.post(\"http://127.0.0.1:5000/api/revoke/book\", {\n          allocation_id: allocation_id,\n          book_id: book_id,\n          user_id: user_id\n        }, {\n          headers: headers\n        });\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.listofallocatedbooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    },\n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = Math.ceil(differenceMs / (1000 * 60 * 60 * 24)) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  }\n};","map":{"version":3,"names":["NavBar","axios","name","components","data","listallocated","created","listofallocatedbooks","methods","headers","Headers","append","localStorage","getItem","response","fetch","method","ok","Error","json","console","log","error","message","takeawayaccess","allocation_id","book_id","user_id","Authorization","post","status","calculateDaysLeft","returnDate","returnDateMs","Date","getTime","currentDateMs","differenceMs","differenceDays","Math","ceil"],"sources":["C:\\Users\\vijay\\OneDrive\\Desktop\\National-Library-LMS\\Library_Code\\frontend_library\\src\\views\\Librarian\\AssignedBooks.vue"],"sourcesContent":["<template>\n  <NavBar />\n  <div>\n  <h2 style=\"text-align: center;margin-top:2.5%\">Allocated Books</h2>\n\n\n  <div v-if=\"listallocated.length > 0\">\n    <table class=\"table center-table\">\n      <thead>\n        <tr>\n          <th>Book Name</th>\n          <th>User Name</th>\n          <th>Date & Time of Issue</th>\n          <th>Return Date</th>\n          <th>Days Left</th>\n          <th>Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"book in listallocated\" :key=\"book.book_id\">\n          <td>{{ book.book_name }}</td>\n          <td>{{ book.user_name }}</td>\n          <td>{{ book.date_of_issue }}</td>\n          <td>{{ book.return_date }}</td>\n          <td>{{ calculateDaysLeft(book.return_date) }}</td>\n          <td>\n            <button class=\"btn btn-danger mw-100\" @click=\"\n              takeawayaccess(book.allocation_id, book.book_id, book.user_id)\n              \">\n              Revoke\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <div v-else>\n    <p>User has not beein assigned any book yet</p>\n  </div>\n\n</div>\n</template>\n\n<script>\nimport NavBar from \"../../components/NavBar.vue\";\nimport axios from \"axios\";\nexport default {\n  name: \"AssignedBooks\",\n  components: {\n    NavBar,\n  },\n  data() {\n    return {\n      listallocated: [],\n    };\n  },\n  created() {\n    this.listofallocatedbooks();\n  },\n  methods: {\n    async listofallocatedbooks() {\n      try {\n        const headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        headers.append(\n          \"Authorization\",\n          `Bearer ${localStorage.getItem(\"accessToken\")}`\n        );\n\n        const response = await fetch(\n          \"http://127.0.0.1:5000/api/librarian/allocated_books\",\n          {\n            method: \"PUT\",\n            headers: headers,\n          }\n        );\n\n        if (!response.ok) {\n          throw new Error(\"Failed to fetch allocated books\");\n        }\n\n        const data = await response.json();\n        this.listallocated = data;\n        console.log(this.listallocated);\n        console.log(data);\n      } catch (error) {\n        console.error(\"Error:\", error.message);\n      }\n    },\n\n    async takeawayaccess(allocation_id, book_id, user_id) {\n      try {\n        const headers = {\n          Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n        };\n\n        const response = await axios.post(\n          \"http://127.0.0.1:5000/api/revoke/book\",\n          {\n            allocation_id: allocation_id,\n            book_id: book_id,\n            user_id: user_id,\n          },\n          { headers: headers }\n        );\n\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.listofallocatedbooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    }\n    ,\n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = (Math.ceil(differenceMs / (1000 * 60 * 60 * 24))) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  },\n};\n</script>\n\n<style scoped>\n.btn {\n\n  justify-content: space-around;\n  align-items: center;\n  padding: 5%;\n  margin: 2%;\n}\n\n\n*,\n*:before,\n*:after {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n\ntable {\n  width: 90%;\n  background: #333;\n  border-radius: 0.25em;\n  border-collapse: collapse;\n  margin-left:5%;\n  margin-top: 2%;\n}\n\nth {\n  border-bottom: 1px solid #364043;\n  color: #E2B842;\n  font-size:large;\n  font-weight: 600;\n  padding: 0.3em 1em;\n  text-align: left;\n}\n\ntd {\n  color: #fff;\n  font-weight: 400;\n  padding: 0.65em;\n  text-align: left;\n}\n\n.disabled td {\n  color: #4F5F64;\n}\n\ntbody tr {\n  transition: background 0.25s ease;\n}\n\ntbody tr:hover {\n  background: #014055;\n}\n</style>"],"mappings":"AA4CA,OAAOA,MAAK,MAAO,6BAA6B;AAChD,OAAOC,KAAI,MAAO,OAAO;AACzB,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,UAAU,EAAE;IACVH;EACF,CAAC;EACDI,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,aAAa,EAAE;IACjB,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,oBAAoB,CAAC,CAAC;EAC7B,CAAC;EACDC,OAAO,EAAE;IACP,MAAMD,oBAAoBA,CAAA,EAAG;MAC3B,IAAI;QACF,MAAME,OAAM,GAAI,IAAIC,OAAO,CAAC,CAAC;QAC7BD,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;QAClDF,OAAO,CAACE,MAAM,CACZ,eAAe,EACd,UAASC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAE,EAChD,CAAC;QAED,MAAMC,QAAO,GAAI,MAAMC,KAAK,CAC1B,qDAAqD,EACrD;UACEC,MAAM,EAAE,KAAK;UACbP,OAAO,EAAEA;QACX,CACF,CAAC;QAED,IAAI,CAACK,QAAQ,CAACG,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAC,iCAAiC,CAAC;QACpD;QAEA,MAAMd,IAAG,GAAI,MAAMU,QAAQ,CAACK,IAAI,CAAC,CAAC;QAClC,IAAI,CAACd,aAAY,GAAID,IAAI;QACzBgB,OAAO,CAACC,GAAG,CAAC,IAAI,CAAChB,aAAa,CAAC;QAC/Be,OAAO,CAACC,GAAG,CAACjB,IAAI,CAAC;MACnB,EAAE,OAAOkB,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAAC,QAAQ,EAAEA,KAAK,CAACC,OAAO,CAAC;MACxC;IACF,CAAC;IAED,MAAMC,cAAcA,CAACC,aAAa,EAAEC,OAAO,EAAEC,OAAO,EAAE;MACpD,IAAI;QACF,MAAMlB,OAAM,GAAI;UACdmB,aAAa,EAAG,UAAShB,YAAY,CAACC,OAAO,CAAC,aAAa,CAAE;QAC/D,CAAC;QAED,MAAMC,QAAO,GAAI,MAAMb,KAAK,CAAC4B,IAAI,CAC/B,uCAAuC,EACvC;UACEJ,aAAa,EAAEA,aAAa;UAC5BC,OAAO,EAAEA,OAAO;UAChBC,OAAO,EAAEA;QACX,CAAC,EACD;UAAElB,OAAO,EAAEA;QAAQ,CACrB,CAAC;QAED,IAAIK,QAAQ,CAACgB,MAAK,KAAM,GAAG,EAAE;UAC3BV,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;UACzC,IAAI,CAACd,oBAAoB,CAAC,CAAC;QAC7B,OAAO;UACLa,OAAO,CAACE,KAAK,CAAC,2BAA2B,CAAC;QAC5C;MACF,EAAE,OAAOA,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACnD;IACF;IAEAS,iBAAiBA,CAACC,UAAU,EAAE;MAC5B,MAAMC,YAAW,GAAI,IAAIC,IAAI,CAACF,UAAU,CAAC,CAACG,OAAO,CAAC,CAAC;MACnD,MAAMC,aAAY,GAAI,IAAIF,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MAC1C,MAAME,YAAW,GAAIJ,YAAW,GAAIG,aAAa;MACjD,MAAME,cAAa,GAAKC,IAAI,CAACC,IAAI,CAACH,YAAW,IAAK,IAAG,GAAI,EAAC,GAAI,EAAC,GAAI,EAAE,CAAC,CAAC,GAAI,CAAC;MAC5E,OAAOC,cAAa,IAAK,IAAIA,cAAa,GAAI,CAAC;IACjD;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}