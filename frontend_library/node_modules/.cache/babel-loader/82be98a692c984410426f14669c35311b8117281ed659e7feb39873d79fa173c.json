{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-129969af\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  style: {\n    \"text-align\": \"center\",\n    \"margin-top\": \"1%\"\n  }\n}, \"Requested Books\", -1 /* HOISTED */));\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  class: \"table center-table\"\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"Book Name\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Requested By\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Grant\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Reject\")])], -1 /* HOISTED */));\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = {\n  key: 1\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"You have no pending requests\", -1 /* HOISTED */));\nconst _hoisted_9 = [_hoisted_8];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_NavBar = _resolveComponent(\"NavBar\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_NavBar), _hoisted_1, $data.listrequested.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"table\", _hoisted_3, [_hoisted_4, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.listrequested, book => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: book.book_id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(book.book_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(book.user_name), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      class: \"btn btn-success\",\n      onClick: $event => $options.approve(book.book_id, book.user_id)\n    }, \" Grant \", 8 /* PROPS */, _hoisted_5)]), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      class: \"btn btn-danger\",\n      onClick: $event => $options.takeback(book.allocation_id)\n    }, \" Reject \", 8 /* PROPS */, _hoisted_6)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [..._hoisted_9]))]);\n}","map":{"version":3,"names":["_createElementVNode","style","key","class","_hoisted_8","_createElementBlock","_createVNode","_component_NavBar","_hoisted_1","$data","listrequested","length","_hoisted_2","_hoisted_3","_hoisted_4","_Fragment","_renderList","book","book_id","_toDisplayString","book_name","user_name","onClick","$event","$options","approve","user_id","_hoisted_5","takeback","allocation_id","_hoisted_6","_hoisted_7","_hoisted_9"],"sources":["C:\\Users\\vijay\\OneDrive\\Desktop\\National-Library-LMS\\Library_Code\\frontend_library\\src\\views\\Librarian\\RequestedReading.vue"],"sourcesContent":["<template>\n  <div>\n    <NavBar />\n<h2 style=\"text-align: center;margin-top:1%\">Requested Books</h2>\n\n  <div v-if=\"listrequested.length > 0\">\n    <table class=\"table center-table\">\n      <thead>\n        <tr>\n          <th>Book Name</th>\n          <th>Requested By</th>\n          <th>Grant</th>\n          <th>Reject</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"book in listrequested\" :key=\"book.book_id\">\n          <td>{{ book.book_name }}</td>\n          <td>{{ book.user_name }}</td>\n          <td>\n            <button class=\"btn btn-success\" @click=\"\n              approve(\n                book.book_id,\n                book.user_id\n              )\n              \">\n              Grant\n            </button>\n          </td>\n          <td>\n            <button class=\"btn btn-danger\" @click=\"takeback(book.allocation_id)\">\n              Reject\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <div v-else>\n    <p>You have no pending requests</p>\n  </div>\n\n</div>\n</template>\n\n<script>\nimport NavBar from \"../../components/NavBar.vue\";\nexport default {\n  name: \"RequestedReading\",\n  components: {\n    NavBar,\n  },\n  data() {\n    return {\n      listrequested: [],\n    };\n  },\n  mounted() {\n    this.listofbooks();\n  },\n  methods: {\n    async listofbooks() {\n      try {\n        const response = await fetch(\n          \"http://127.0.0.1:5000/api/books/requested\",\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n            },\n          }\n        );\n        const data = await response.json();\n        if (response.ok) {\n          this.listrequested = data;\n          console.log(\"Requested books: \", data);\n        } else {\n          console.error(\"Failed to fetch requested books: \", data.error);\n        }\n      } catch (error) {\n        console.error(\"Error fetching requested books: \", error);\n      }\n    },\n    async approve(bookId, userId) {\n      try {\n        console.log(userId);\n        const response = await fetch(\n          \"http://127.0.0.1:5000/api/books/allocate\",\n          {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n            },\n            body: JSON.stringify({\n              book_id: bookId,\n              user_id: userId,\n            }),\n          }\n        );\n        const data = await response.json();\n        if (response.ok) {\n          console.log(\"Book has been granted\", data.message);\n          this.listofbooks();\n        } else {\n          console.error(\"Some error occured \", data.error);\n        }\n      } catch (error) {\n        console.error(\"Error: \", error);\n      }\n    },\n    async takeback(allocationId) {\n      try {\n        const response = await fetch(\n          \"http://127.0.0.1:5000/api/delete/request\",\n          {\n            method: \"DELETE\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n            },\n            body: JSON.stringify({\n              allocation_id: allocationId,\n            }),\n          }\n        );\n\n\n        if (!response.ok) {\n          throw new Error(\"Failed to revoke access\");\n        }\n        else {\n          this.listofbooks();\n        }\n\n        const data = await response.json();\n        console.log(data);\n      } catch (error) {\n        console.error(\"Error revoking access:\", error);\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.btn {\n\n  justify-content: space-around;\n  align-items: center;\n  padding: 5%;\n  margin: 2%;\n}\n\n\n*,\n*:before,\n*:after {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n\ntable {\n  width: 90%;\n  background: #333;\n  border-radius: 0.25em;\n  border-collapse: collapse;\n  margin-left: 5%;\n  margin-top: 2%;\n}\n\nth {\n  border-bottom: 1px solid #364043;\n  color: #E2B842;\n  font-size: large;\n  font-weight: 600;\n  padding: 0.5em 1em;\n  text-align: left;\n}\n\ntd {\n  color: #fff;\n  font-weight: 400;\n  padding: 0.65em 1em;\n  text-align: left;\n}\n\n.disabled td {\n  color: #4F5F64;\n}\n\ntbody tr {\n  transition: background 0.25s ease;\n}\n\ntbody tr:hover {\n  background: #014055;\n}\n</style>\n"],"mappings":";;gEAGAA,mBAAA,CAAiE;EAA7DC,KAAwC,EAAxC;IAAA;IAAA;EAAA;AAAwC,GAAC,iBAAe;;EAH5DC,GAAA;AAAA;;EAMWC,KAAK,EAAC;AAAoB;gEAC/BH,mBAAA,CAOQ,gB,aANNA,mBAAA,CAKK,a,aAJHA,mBAAA,CAAkB,YAAd,WAAS,G,aACbA,mBAAA,CAAqB,YAAjB,cAAY,G,aAChBA,mBAAA,CAAc,YAAV,OAAK,G,aACTA,mBAAA,CAAe,YAAX,QAAM,E;mBAZpB;mBAAA;;EAAAE,GAAA;AAAA;gEAuCIF,mBAAA,CAAmC,WAAhC,8BAA4B;oBAA/BI,UAAmC,C;;;uBAtCrCC,mBAAA,CAyCI,cAxCFC,YAAA,CAAUC,iBAAA,GACdC,UAAiE,EAEpDC,KAAA,CAAAC,aAAa,CAACC,MAAM,Q,cAA/BN,mBAAA,CAgCM,OArCRO,UAAA,GAMIZ,mBAAA,CA8BQ,SA9BRa,UA8BQ,GA7BNC,UAOQ,EACRd,mBAAA,CAoBQ,iB,kBAnBNK,mBAAA,CAkBKU,SAAA,QAlCbC,WAAA,CAgB2BP,KAAA,CAAAC,aAAa,EAArBO,IAAI;yBAAfZ,mBAAA,CAkBK;MAlB8BH,GAAG,EAAEe,IAAI,CAACC;QAC3ClB,mBAAA,CAA6B,YAAAmB,gBAAA,CAAtBF,IAAI,CAACG,SAAS,kBACrBpB,mBAAA,CAA6B,YAAAmB,gBAAA,CAAtBF,IAAI,CAACI,SAAS,kBACrBrB,mBAAA,CASK,aARHA,mBAAA,CAOS;MAPDG,KAAK,EAAC,iBAAiB;MAAEmB,OAAK,EAAAC,MAAA,IAAiBC,QAAA,CAAAC,OAAO,CAAkBR,IAAI,CAACC,OAAO,EAAkBD,IAAI,CAACS,O;OAK/G,SAEJ,iBA3BZC,UAAA,E,GA6BU3B,mBAAA,CAIK,aAHHA,mBAAA,CAES;MAFDG,KAAK,EAAC,gBAAgB;MAAEmB,OAAK,EAAAC,MAAA,IAAEC,QAAA,CAAAI,QAAQ,CAACX,IAAI,CAACY,aAAa;OAAG,UAErE,iBAhCZC,UAAA,E;yDAsCEzB,mBAAA,CAEM,OAxCR0B,UAAA,MAAAC,UAAA,I","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}