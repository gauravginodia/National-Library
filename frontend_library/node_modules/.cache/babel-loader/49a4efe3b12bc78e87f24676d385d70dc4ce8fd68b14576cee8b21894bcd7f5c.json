{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport NavBar from \"../../components/NavBar.vue\"; // Make sure to adjust the path if necessary\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      myBooks: [],\n      rating: null,\n      comments: \"\",\n      searchQuery: \"\"\n    };\n  },\n  methods: {\n    readBook(book_id) {\n      this.$router.push({\n        name: 'BookPage',\n        params: {\n          id: book_id\n        }\n      });\n    },\n    searchBooks() {\n      return this.myBooks.filter(book => {\n        const searchMatch = book.name && book.name.toLowerCase().includes(this.searchQuery.toLowerCase()) || book.authors && book.authors.toLowerCase().includes(this.searchQuery.toLowerCase());\n        return this.searchQuery === \"\" || searchMatch;\n      });\n    },\n    async fetchIssuedBooks() {\n      try {\n        const response = await axios.get(\"http://127.0.0.1:5000/api/fetch_my_books\", {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n          }\n        });\n        if (response.status === 200) {\n          this.myBooks = response.data;\n          await this.fetchBookCovers();\n        } else {\n          console.error(\"Failed to fetch my books\");\n        }\n      } catch (error) {\n        console.error(\"Error fetching my books:\", error);\n      }\n    },\n    async fetchBookCovers() {\n      for (const book of this.myBooks) {\n        try {\n          const coverUrl = await this.getBookCover(book);\n          book.coverUrl = coverUrl;\n        } catch (error) {\n          console.error(\"Error fetching book cover:\", error);\n          book.coverUrl = null;\n        }\n      }\n    },\n    getBookCover(book) {\n      const apiUrl = `http://localhost:5000/bookcover?book_title=${encodeURIComponent(book.name)}\n      &author_name=${encodeURIComponent(book.authors)}\n      &isbn=${encodeURIComponent(book.isbn)}`;\n      return axios.get(apiUrl).then(response => {\n        console.log(response.data);\n        return response.data;\n      }).catch(error => {\n        console.error(\"Error fetching book cover:\", error);\n        return null;\n      });\n    },\n    async returnBook(book_id, user_id) {\n      try {\n        const response = await axios.post(\"http://127.0.0.1:5000/api/return/book\", {\n          book_id: book_id,\n          user_id: user_id\n        }, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n          }\n        });\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.fetchIssuedBooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    },\n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = Math.ceil(differenceMs / (1000 * 60 * 60 * 24)) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  },\n  mounted() {\n    this.fetchIssuedBooks();\n  },\n  components: {\n    NavBar\n  }\n};","map":{"version":3,"names":["NavBar","axios","data","myBooks","rating","comments","searchQuery","methods","readBook","book_id","$router","push","name","params","id","searchBooks","filter","book","searchMatch","toLowerCase","includes","authors","fetchIssuedBooks","response","get","headers","Authorization","localStorage","getItem","status","fetchBookCovers","console","error","coverUrl","getBookCover","apiUrl","encodeURIComponent","isbn","then","log","catch","returnBook","user_id","post","calculateDaysLeft","returnDate","returnDateMs","Date","getTime","currentDateMs","differenceMs","differenceDays","Math","ceil","mounted","components"],"sources":["C:\\Users\\vijay\\OneDrive\\Desktop\\National-Library-LMS\\Library_Code\\frontend_library\\src\\views\\User\\IssuedBooks.vue"],"sourcesContent":["<template>\n  <div>\n    <NavBar />\n    <h3 style=\"text-align: center;font-weight: bold;margin-top: 2%;\">Your Books</h3>\n\n    <div v-if=\"myBooks.length > 0\">\n      <div class=\"row\">\n        <div v-for=\"book in myBooks\" :key=\"book.book_id\" class=\"card\" style=\"background-color: whitesmoke;\">\n          <div class=\"card-body\">\n            <template v-if=\"book.coverUrl\">\n              <img :src=\"book.coverUrl\" class=\"card-img-top\" alt=\"Book Cover\">\n            </template>\n            <template v-else>\n              <img src=\"@/assets/default.jpeg\" class=\"card-img-top\" alt=\"Default Cover\">\n            </template>\n            <h6 class=\"card-subtitle mb-2 text-muted\" style=\"text-align: center;\"> by {{ book.authors }}</h6>\n            <div class=\"book-actions d-flex text-center\" style=\"justify-content: center;\">\n              <button type=\"button\" class=\"btn btn-primary mr-2\" @click=\"readBook(book.book_id)\">\n                Read\n              </button>\n              <button type=\"button\" class=\"btn btn-warning\" @click=\"returnBook(book.book_id, book.user_id)\">\n                Return\n              </button>\n\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"../../components/NavBar.vue\"; // Make sure to adjust the path if necessary\nimport axios from \"axios\";\n\nexport default {\n  data() {\n    return {\n      myBooks: [],\n      rating: null,\n      comments: \"\",\n      searchQuery: \"\",\n    };\n  },\n\n  methods: {\n    readBook(book_id) {\n      this.$router.push({ name: 'BookPage', params: { id: book_id} });\n    },\n    searchBooks() {\n      return this.myBooks.filter(book => {\n        const searchMatch =\n          (book.name && book.name.toLowerCase().includes(this.searchQuery.toLowerCase())) ||\n          (book.authors && book.authors.toLowerCase().includes(this.searchQuery.toLowerCase()));\n        return (this.searchQuery === \"\" || searchMatch);\n      });\n    }\n    ,\n    async fetchIssuedBooks() {\n      try {\n        const response = await axios.get(\n          \"http://127.0.0.1:5000/api/fetch_my_books\",\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n            }\n          }\n        );\n        if (response.status === 200) {\n          this.myBooks = response.data;\n          await this.fetchBookCovers();\n        } else {\n          console.error(\"Failed to fetch my books\");\n        }\n      } catch (error) {\n        console.error(\"Error fetching my books:\", error);\n      }\n    },\n    async fetchBookCovers() {\n      for (const book of this.myBooks) {\n        try {\n          const coverUrl = await this.getBookCover(book);\n          book.coverUrl = coverUrl;\n        } catch (error) {\n          console.error(\"Error fetching book cover:\", error);\n          book.coverUrl = null;\n        }\n      }\n    },\n    \n    getBookCover(book) {\n      const apiUrl = `http://localhost:5000/bookcover?book_title=${encodeURIComponent(book.name)}\n      &author_name=${encodeURIComponent(book.authors)}\n      &isbn=${encodeURIComponent(book.isbn)}`;\n\n      return axios\n        .get(apiUrl)\n        .then((response) => {\n          console.log(response.data);\n          return response.data;\n        })\n        .catch((error) => {\n          console.error(\"Error fetching book cover:\", error);\n          return null;\n        });\n    },\n    async returnBook(book_id, user_id) {\n      try {\n        const response = await axios.post(\n          \"http://127.0.0.1:5000/api/return/book\",\n          {\n            book_id: book_id,\n            user_id: user_id\n          },\n          {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`\n            }\n          }\n        );\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.fetchIssuedBooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    },\n \n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = Math.ceil(differenceMs / (1000 * 60 * 60 * 24)) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  },\n  mounted() {\n    this.fetchIssuedBooks();\n  },\n  components: {\n    NavBar\n  }\n};\n</script>\n\n<style scoped>\n.btn {\n  display: flex;\n  justify-content: center;\n  background-color: coral;\n  color: white;\n  border: none;\n  margin-left: 10px;\n  margin-top: 5px;\n  margin-bottom: 5px;\n  padding: 5px 10px;\n}\n\n.btn:hover {\n  background-color: #ff4500;\n}\n\n.ano {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  gap: 5px;\n}\n\n\n.book-cover {\n  height: 150px;\n  align-items: start;\n  object-fit: contain;\n  margin-bottom: 0.25rem;\n}\n\n.book-cover.disabled-image {\n  opacity: 0.5;\n}\n\n\n\n.row {\n  margin-left: 0.75%;\n  align-items: stretch;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  overflow-x: auto;\n  overflow-y: hidden;\n}\n\n.card {\n  max-width: 13.333%;\n  padding: .75rem;\n  margin-bottom: 2rem;\n  border: 0;\n  flex-basis: 33.333%;\n  flex-grow: 0;\n  flex-shrink: 0;\n}\n\n.card-img-top {\n  margin-bottom: .75rem;\n  width: 100%;\n  height: 300px;\n}\n\n.card-text {\n  font-size: 85%;\n}\n</style>\n"],"mappings":";AAiCA,OAAOA,MAAK,MAAO,6BAA6B,EAAE;AAClD,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,OAAO,EAAE,EAAE;MACXC,MAAM,EAAE,IAAI;MACZC,QAAQ,EAAE,EAAE;MACZC,WAAW,EAAE;IACf,CAAC;EACH,CAAC;EAEDC,OAAO,EAAE;IACPC,QAAQA,CAACC,OAAO,EAAE;MAChB,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE,UAAU;QAAEC,MAAM,EAAE;UAAEC,EAAE,EAAEL;QAAO;MAAE,CAAC,CAAC;IACjE,CAAC;IACDM,WAAWA,CAAA,EAAG;MACZ,OAAO,IAAI,CAACZ,OAAO,CAACa,MAAM,CAACC,IAAG,IAAK;QACjC,MAAMC,WAAU,GACbD,IAAI,CAACL,IAAG,IAAKK,IAAI,CAACL,IAAI,CAACO,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAI,CAACd,WAAW,CAACa,WAAW,CAAC,CAAC,CAAC,IAC7EF,IAAI,CAACI,OAAM,IAAKJ,IAAI,CAACI,OAAO,CAACF,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAI,CAACd,WAAW,CAACa,WAAW,CAAC,CAAC,CAAE;QACvF,OAAQ,IAAI,CAACb,WAAU,KAAM,EAAC,IAAKY,WAAW;MAChD,CAAC,CAAC;IACJ;IAEA,MAAMI,gBAAgBA,CAAA,EAAG;MACvB,IAAI;QACF,MAAMC,QAAO,GAAI,MAAMtB,KAAK,CAACuB,GAAG,CAC9B,0CAA0C,EAC1C;UACEC,OAAO,EAAE;YACPC,aAAa,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAE;UAC/D;QACF,CACF,CAAC;QACD,IAAIL,QAAQ,CAACM,MAAK,KAAM,GAAG,EAAE;UAC3B,IAAI,CAAC1B,OAAM,GAAIoB,QAAQ,CAACrB,IAAI;UAC5B,MAAM,IAAI,CAAC4B,eAAe,CAAC,CAAC;QAC9B,OAAO;UACLC,OAAO,CAACC,KAAK,CAAC,0BAA0B,CAAC;QAC3C;MACF,EAAE,OAAOA,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAClD;IACF,CAAC;IACD,MAAMF,eAAeA,CAAA,EAAG;MACtB,KAAK,MAAMb,IAAG,IAAK,IAAI,CAACd,OAAO,EAAE;QAC/B,IAAI;UACF,MAAM8B,QAAO,GAAI,MAAM,IAAI,CAACC,YAAY,CAACjB,IAAI,CAAC;UAC9CA,IAAI,CAACgB,QAAO,GAAIA,QAAQ;QAC1B,EAAE,OAAOD,KAAK,EAAE;UACdD,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;UAClDf,IAAI,CAACgB,QAAO,GAAI,IAAI;QACtB;MACF;IACF,CAAC;IAEDC,YAAYA,CAACjB,IAAI,EAAE;MACjB,MAAMkB,MAAK,GAAK,8CAA6CC,kBAAkB,CAACnB,IAAI,CAACL,IAAI,CAAC;qBAC3EwB,kBAAkB,CAACnB,IAAI,CAACI,OAAO,CAAC;cACvCe,kBAAkB,CAACnB,IAAI,CAACoB,IAAI,CAAE,EAAC;MAEvC,OAAOpC,KAAI,CACRuB,GAAG,CAACW,MAAM,EACVG,IAAI,CAAEf,QAAQ,IAAK;QAClBQ,OAAO,CAACQ,GAAG,CAAChB,QAAQ,CAACrB,IAAI,CAAC;QAC1B,OAAOqB,QAAQ,CAACrB,IAAI;MACtB,CAAC,EACAsC,KAAK,CAAER,KAAK,IAAK;QAChBD,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClD,OAAO,IAAI;MACb,CAAC,CAAC;IACN,CAAC;IACD,MAAMS,UAAUA,CAAChC,OAAO,EAAEiC,OAAO,EAAE;MACjC,IAAI;QACF,MAAMnB,QAAO,GAAI,MAAMtB,KAAK,CAAC0C,IAAI,CAC/B,uCAAuC,EACvC;UACElC,OAAO,EAAEA,OAAO;UAChBiC,OAAO,EAAEA;QACX,CAAC,EACD;UACEjB,OAAO,EAAE;YACPC,aAAa,EAAG,UAASC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAE;UAC/D;QACF,CACF,CAAC;QACD,IAAIL,QAAQ,CAACM,MAAK,KAAM,GAAG,EAAE;UAC3BE,OAAO,CAACQ,GAAG,CAAC,4BAA4B,CAAC;UACzC,IAAI,CAACjB,gBAAgB,CAAC,CAAC;QACzB,OAAO;UACLS,OAAO,CAACC,KAAK,CAAC,2BAA2B,CAAC;QAC5C;MACF,EAAE,OAAOA,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACnD;IACF,CAAC;IAEDY,iBAAiBA,CAACC,UAAU,EAAE;MAC5B,MAAMC,YAAW,GAAI,IAAIC,IAAI,CAACF,UAAU,CAAC,CAACG,OAAO,CAAC,CAAC;MACnD,MAAMC,aAAY,GAAI,IAAIF,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;MAC1C,MAAME,YAAW,GAAIJ,YAAW,GAAIG,aAAa;MACjD,MAAME,cAAa,GAAIC,IAAI,CAACC,IAAI,CAACH,YAAW,IAAK,IAAG,GAAI,EAAC,GAAI,EAAC,GAAI,EAAE,CAAC,IAAI,CAAC;MAC1E,OAAOC,cAAa,IAAK,IAAIA,cAAa,GAAI,CAAC;IACjD;EACF,CAAC;EACDG,OAAOA,CAAA,EAAG;IACR,IAAI,CAAChC,gBAAgB,CAAC,CAAC;EACzB,CAAC;EACDiC,UAAU,EAAE;IACVvD;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}