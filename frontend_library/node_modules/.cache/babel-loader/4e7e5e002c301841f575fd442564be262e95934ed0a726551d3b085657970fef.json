{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-135ff1db\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  style: {\n    \"text-align\": \"center\",\n    \"margin-top\": \"2.5%\"\n  }\n}, \"Allocated Books\", -1 /* HOISTED */));\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  class: \"table center-table\"\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"Book Name\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"User Name\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Date & Time of Issue\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Return Date\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Days Left\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"Action\")])], -1 /* HOISTED */));\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = {\n  key: 1\n};\nconst _hoisted_7 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"User has not beein assigned any book yet\", -1 /* HOISTED */));\nconst _hoisted_8 = [_hoisted_7];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_NavBar = _resolveComponent(\"NavBar\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_NavBar), _createElementVNode(\"div\", null, [_hoisted_1, $data.listallocated.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"table\", _hoisted_3, [_hoisted_4, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.listallocated, book => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: book.book_id\n    }, [_createElementVNode(\"td\", null, _toDisplayString(book.book_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(book.user_name), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(book.date_of_issue), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString(book.return_date), 1 /* TEXT */), _createElementVNode(\"td\", null, _toDisplayString($options.calculateDaysLeft(book.return_date)), 1 /* TEXT */), _createElementVNode(\"td\", null, [_createElementVNode(\"button\", {\n      class: \"btn btn-danger mw-100\",\n      onClick: $event => $options.takeawayaccess(book.allocation_id, book.book_id, book.user_id)\n    }, \" Revoke \", 8 /* PROPS */, _hoisted_5)])]);\n  }), 128 /* KEYED_FRAGMENT */))])])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [..._hoisted_8]))])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["_createElementVNode","style","key","class","_hoisted_7","_createElementBlock","_Fragment","_createVNode","_component_NavBar","_hoisted_1","$data","listallocated","length","_hoisted_2","_hoisted_3","_hoisted_4","_renderList","book","book_id","_toDisplayString","book_name","user_name","date_of_issue","return_date","$options","calculateDaysLeft","onClick","$event","takeawayaccess","allocation_id","user_id","_hoisted_5","_hoisted_6","_hoisted_8"],"sources":["C:\\Users\\vijay\\OneDrive\\Desktop\\National-Library-LMS\\Library_Code\\frontend_library\\src\\views\\Librarian\\AssignedBooks.vue"],"sourcesContent":["<template>\n  <NavBar />\n  <div>\n  <h2 style=\"text-align: center;margin-top:2.5%\">Allocated Books</h2>\n\n\n  <div v-if=\"listallocated.length > 0\">\n    <table class=\"table center-table\">\n      <thead>\n        <tr>\n          <th>Book Name</th>\n          <th>User Name</th>\n          <th>Date & Time of Issue</th>\n          <th>Return Date</th>\n          <th>Days Left</th>\n          <th>Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"book in listallocated\" :key=\"book.book_id\">\n          <td>{{ book.book_name }}</td>\n          <td>{{ book.user_name }}</td>\n          <td>{{ book.date_of_issue }}</td>\n          <td>{{ book.return_date }}</td>\n          <td>{{ calculateDaysLeft(book.return_date) }}</td>\n          <td>\n            <button class=\"btn btn-danger mw-100\" @click=\"\n              takeawayaccess(book.allocation_id, book.book_id, book.user_id)\n              \">\n              Revoke\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <div v-else>\n    <p>User has not beein assigned any book yet</p>\n  </div>\n\n</div>\n</template>\n\n<script>\nimport NavBar from \"../../components/NavBar.vue\";\nimport axios from \"axios\";\nexport default {\n  name: \"AssignedBooks\",\n  components: {\n    NavBar,\n  },\n  data() {\n    return {\n      listallocated: [],\n    };\n  },\n  created() {\n    this.listofallocatedbooks();\n  },\n  methods: {\n    async listofallocatedbooks() {\n      try {\n        const headers = new Headers();\n        headers.append(\"Content-Type\", \"application/json\");\n        headers.append(\n          \"Authorization\",\n          `Bearer ${localStorage.getItem(\"accessToken\")}`\n        );\n\n        const response = await fetch(\n          \"http://127.0.0.1:5000/api/librarian/allocated_books\",\n          {\n            method: \"PUT\",\n            headers: headers,\n          }\n        );\n\n        if (!response.ok) {\n          throw new Error(\"Failed to fetch allocated books\");\n        }\n\n        const data = await response.json();\n        this.listallocated = data;\n        console.log(this.listallocated);\n        console.log(data);\n      } catch (error) {\n        console.error(\"Error:\", error.message);\n      }\n    },\n\n    async takeawayaccess(allocation_id, book_id, user_id) {\n      try {\n        const headers = {\n          Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}`,\n        };\n\n        const response = await axios.post(\n          \"http://127.0.0.1:5000/api/revoke/book\",\n          {\n            allocation_id: allocation_id,\n            book_id: book_id,\n            user_id: user_id,\n          },\n          { headers: headers }\n        );\n\n        if (response.status === 200) {\n          console.log(\"Book returned successfully\");\n          this.listofallocatedbooks();\n        } else {\n          console.error(\"Failed to return the book\");\n        }\n      } catch (error) {\n        console.error(\"Error returning the book:\", error);\n      }\n    }\n    ,\n    calculateDaysLeft(returnDate) {\n      const returnDateMs = new Date(returnDate).getTime();\n      const currentDateMs = new Date().getTime();\n      const differenceMs = returnDateMs - currentDateMs;\n      const differenceDays = (Math.ceil(differenceMs / (1000 * 60 * 60 * 24))) - 1;\n      return differenceDays >= 0 ? differenceDays : 0;\n    }\n  },\n};\n</script>\n\n<style scoped>\n.btn {\n\n  justify-content: space-around;\n  align-items: center;\n  padding: 5%;\n  margin: 2%;\n}\n\n\n*,\n*:before,\n*:after {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\n\ntable {\n  width: 90%;\n  background: #333;\n  border-radius: 0.25em;\n  border-collapse: collapse;\n  margin-left:5%;\n  margin-top: 2%;\n}\n\nth {\n  border-bottom: 1px solid #364043;\n  color: #E2B842;\n  font-size:large;\n  font-weight: 600;\n  padding: 0.3em 1em;\n  text-align: left;\n}\n\ntd {\n  color: #fff;\n  font-weight: 400;\n  padding: 0.65em;\n  text-align: left;\n}\n\n.disabled td {\n  color: #4F5F64;\n}\n\ntbody tr {\n  transition: background 0.25s ease;\n}\n\ntbody tr:hover {\n  background: #014055;\n}\n</style>"],"mappings":";;gEAGEA,mBAAA,CAAmE;EAA/DC,KAA0C,EAA1C;IAAA;IAAA;EAAA;AAA0C,GAAC,iBAAe;;EAHhEC,GAAA;AAAA;;EAOWC,KAAK,EAAC;AAAoB;gEAC/BH,mBAAA,CASQ,gB,aARNA,mBAAA,CAOK,a,aANHA,mBAAA,CAAkB,YAAd,WAAS,G,aACbA,mBAAA,CAAkB,YAAd,WAAS,G,aACbA,mBAAA,CAA6B,YAAzB,sBAAoB,G,aACxBA,mBAAA,CAAoB,YAAhB,aAAW,G,aACfA,mBAAA,CAAkB,YAAd,WAAS,G,aACbA,mBAAA,CAAe,YAAX,QAAM,E;mBAfpB;;EAAAE,GAAA;AAAA;gEAqCIF,mBAAA,CAA+C,WAA5C,0CAAwC;oBAA3CI,UAA+C,C;;;uBArCnDC,mBAAA,CAAAC,SAAA,SACEC,YAAA,CAAUC,iBAAA,GACVR,mBAAA,CAsCI,cArCJS,UAAmE,EAGxDC,KAAA,CAAAC,aAAa,CAACC,MAAM,Q,cAA/BP,mBAAA,CA6BM,OAnCRQ,UAAA,GAOIb,mBAAA,CA2BQ,SA3BRc,UA2BQ,GA1BNC,UASQ,EACRf,mBAAA,CAeQ,iB,kBAdNK,mBAAA,CAaKC,SAAA,QAhCbU,WAAA,CAmB2BN,KAAA,CAAAC,aAAa,EAArBM,IAAI;yBAAfZ,mBAAA,CAaK;MAb8BH,GAAG,EAAEe,IAAI,CAACC;QAC3ClB,mBAAA,CAA6B,YAAAmB,gBAAA,CAAtBF,IAAI,CAACG,SAAS,kBACrBpB,mBAAA,CAA6B,YAAAmB,gBAAA,CAAtBF,IAAI,CAACI,SAAS,kBACrBrB,mBAAA,CAAiC,YAAAmB,gBAAA,CAA1BF,IAAI,CAACK,aAAa,kBACzBtB,mBAAA,CAA+B,YAAAmB,gBAAA,CAAxBF,IAAI,CAACM,WAAW,kBACvBvB,mBAAA,CAAkD,YAAAmB,gBAAA,CAA3CK,QAAA,CAAAC,iBAAiB,CAACR,IAAI,CAACM,WAAW,mBACzCvB,mBAAA,CAMK,aALHA,mBAAA,CAIS;MAJDG,KAAK,EAAC,uBAAuB;MAAEuB,OAAK,EAAAC,MAAA,IAAiBH,QAAA,CAAAI,cAAc,CAACX,IAAI,CAACY,aAAa,EAAEZ,IAAI,CAACC,OAAO,EAAED,IAAI,CAACa,OAAO;OAEtH,UAEJ,iBA9BZC,UAAA,E;yDAoCE1B,mBAAA,CAEM,OAtCR2B,UAAA,MAAAC,UAAA,I","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}